services:
  tinyauth:
    image: ghcr.io/steveiliop56/tinyauth:v4.0.0
    container_name: ${CONTAINER_NAME}
    environment:
      # ---- 通用配置 ----
      - APP_URL=${PANEL_TINYAUTH_APP_URL}
      - SECRET=${PANEL_TINYAUTH_SECRET}
      - SESSION_EXPIRY=${PANEL_TINYAUTH_SESSION_EXPIRY}
      - APP_TITLE=${PANEL_TINYAUTH_APP_TITLE}
      - OAUTH_AUTO_REDIRECT=${PANEL_TINYAUTH_OAUTH_AUTO_REDIRECT}
      - BACKGROUND_IMAGE=${PANEL_TINYAUTH_BACKGROUND_IMAGE}

      # ---- GitHub ----
      - PROVIDERS_GITHUB_CLIENT_ID=${PANEL_TINYAUTH_GITHUB_CLIENT_ID}
      - PROVIDERS_GITHUB_CLIENT_SECRET=${PANEL_TINYAUTH_GITHUB_CLIENT_SECRET}
      # - PROVIDERS_GITHUB_REDIRECT_URI=${PANEL_TINYAUTH_GITHUB_REDIRECT_URI}

      # ---- Google ----
      - PROVIDERS_GOOGLE_CLIENT_ID=${PANEL_TINYAUTH_GOOGLE_CLIENT_ID}
      - PROVIDERS_GOOGLE_CLIENT_SECRET=${PANEL_TINYAUTH_GOOGLE_CLIENT_SECRET}
      # - PROVIDERS_GOOGLE_REDIRECT_URI=${PANEL_TINYAUTH_GOOGLE_REDIRECT_URI}

      # ---- Generic (示例 Linux.Do) ----
      - PROVIDERS_GENERIC_NAME=${PANEL_TINYAUTH_GENERIC_NAME}
      - PROVIDERS_GENERIC_CLIENT_ID=${PANEL_TINYAUTH_GENERIC_CLIENT_ID}
      - PROVIDERS_GENERIC_CLIENT_SECRET=${PANEL_TINYAUTH_GENERIC_CLIENT_SECRET}
      - PROVIDERS_GENERIC_AUTH_URL=${PANEL_TINYAUTH_GENERIC_AUTH_URL}
      - PROVIDERS_GENERIC_TOKEN_URL=${PANEL_TINYAUTH_GENERIC_TOKEN_URL}
      - PROVIDERS_GENERIC_USER_INFO_URL=${PANEL_TINYAUTH_GENERIC_USER_URL}
      - PROVIDERS_GENERIC_SCOPES=${PANEL_TINYAUTH_GENERIC_SCOPES}

    ports:
      - "${PANEL_APP_PORT_HTTP}:3000"
    labels:
      createdBy: "Apps"
    networks:
      - 1panel-network
    restart: always
    volumes:
      - ./data:/data

networks:
  1panel-network:
    external: true
